<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>이력서 양식</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>

</head>

<body class="bg-gray-100 py-10">
  <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-xl p-8">
    <h1 class="text-2xl font-bold mb-6 text-center">이력서</h1>

    <!-- 개인정보 -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-4">개인정보</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label class="block text-gray-700 mb-2">이름</label>
          <input type="text" class="w-full border rounded-lg p-2 focus:ring focus:ring-blue-300" 
          placeholder="홍길도">
        </div>
        <div>
          <label class="block text-gray-700 mb-2">생년월일</label>
          <input type="date" class="w-full border rounded-lg p-2 focus:ring focus:ring-blue-300">
        </div>
        <div>
          <label class="block text-gray-700 mb-2">전화번호</label>
          <input type="tel" class="w-full border rounded-lg p-2 focus:ring focus:ring-blue-300" 
          placeholder="010-1234-5678">
        </div>
<div>
  <label class="block text-gray-700 mb-2">이메일</label>
  <div class="flex gap-2">
    <!-- 아이디(로컬파트) -->
    <input id="email-local" type="text"
           class="flex-1 border rounded-lg p-2 focus:ring focus:ring-blue-300"
           placeholder="아이디">

    <!-- @ 기호 표시 -->
    <div class="px-2 py-2 text-gray-500 select-none">@</div>

    <!-- 도메인 선택 -->
    <select id="email-domain-select"
            class="w-40 border rounded-lg p-2 focus:ring focus:ring-blue-300">
      <option value="gmail.com">gmail.com</option>
      <option value="naver.com">naver.com</option>
      <option value="daum.net">daum.net</option>
      <option value="outlook.com">outlook.com</option>
      <option value="__custom__">직접입력</option>
    </select>

    <!-- 직접입력용 도메인 인풋(기본 숨김/비활성) -->
    <input id="email-domain" type="text"
           class="w-44 border rounded-lg p-2 focus:ring focus:ring-blue-300 hidden"
           placeholder="example.com" disabled>
  </div>

  <!-- (선택) 폼 제출용 숨김 통합 값 -->
  <input id="email" name="email" type="hidden">
</div>

      </div>
    </section>

    <!-- 학력 -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-4">학력</h2>
      <div class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <input type="text" class="border rounded-lg p-2 focus:ring focus:ring-blue-300" placeholder="학교명">
          <input type="text" class="border rounded-lg p-2 focus:ring focus:ring-blue-300" placeholder="전공">
         <input id="edu-year" type="text"
  class="border rounded-lg p-2 focus:ring focus:ring-blue-300"
  placeholder="졸업 (YYYY-MM)" readonly>

        </div>
      </div>
    </section>

    <!-- 경력 -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-4">경력</h2>
      <div class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <input type="text" class="border rounded-lg p-2 focus:ring focus:ring-blue-300" placeholder="회사명">
          <input type="text" class="border rounded-lg p-2 focus:ring focus:ring-blue-300" placeholder="직무">
          <input type="text" class="border rounded-lg p-2 focus:ring focus:ring-blue-300" placeholder="근무기간 (예: 2019-2023)">
        </div>
      </div>
    </section>

    <!-- 기술 스택 -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-4">기술 스택</h2>
      <textarea class="w-full border rounded-lg p-2 focus:ring focus:ring-blue-300" rows="4" 
      placeholder="예: JavaScript, React, Node.js, AWS..."></textarea>
    </section>

    <!-- 자기소개 -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-4">자기소개</h2>
      <textarea class="w-full border rounded-lg p-2 focus:ring focus:ring-blue-300" rows="6" 
      placeholder="자기소개를 입력하세요"></textarea>
    </section>

    <!-- 버튼 -->
    <div class="flex justify-end gap-4">
      <button type="reset" class="px-6 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">
        초기화
      </button>
      <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
        제출하기
      </button>
    </div>
  </div>

<!-- ✅ 토스트 루트 -->
<div id="toast-root" class="fixed top-4 right-4 z-50 space-y-2 pointer-events-none"></div>

<script>

  /** ---------- Toast 유틸 ---------- */
  function ensureToastRoot() {
    let root = document.getElementById("toast-root");
    if (!root) {
      root = document.createElement("div");
      root.id = "toast-root";
      root.className = "fixed top-4 right-4 z-50 space-y-2 pointer-events-none";
      document.body.appendChild(root);
    }
    return root;
  }
  function showToast(message, type = "info", duration = 2400) {
    const root = ensureToastRoot();
    const base = "pointer-events-auto min-w-[220px] max-w-xs rounded-lg px-4 py-3 shadow-lg text-sm flex items-start gap-2 transition opacity-0 -translate-y-1 bg-white border";
    const color = {
      info: "border-gray-200 text-gray-800",
      success: "border-green-200 text-green-800",
      error: "border-red-200 text-red-800",
      warn: "border-amber-200 text-amber-800",
    }[type] || "border-gray-200 text-gray-800";
    const icon = { info: "ℹ️", success: "✅", error: "⛔", warn: "⚠️" }[type] || "ℹ️";

    const el = document.createElement("div");
    el.className = `${base} ${color}`;
    el.innerHTML = `
      <span class="mt-0.5">${icon}</span>
      <div class="flex-1">${message}</div>
      <button type="button" class="ml-2 text-gray-500 hover:text-gray-700">✖</button>
    `;
    const close = () => { el.classList.add("opacity-0","-translate-y-1"); setTimeout(()=>el.remove(),180); };
    el.querySelector("button").addEventListener("click", close);
    root.appendChild(el);
    requestAnimationFrame(()=>{ el.classList.remove("opacity-0","-translate-y-1"); el.classList.add("opacity-100","translate-y-0"); });
    if (duration > 0) setTimeout(close, duration);
  }

  /** ---------- 입력 요소 자동 탐지 (id 없어도 동작) ---------- */
  const $ = (sel) => document.querySelector(sel);

  // 이름: placeholder가 다를 수 있으니 1) id, 2) 이름 라벨 바로 다음 input, 3) 첫 번째 text input 순서로 탐지
  let nameInput = $("#name");
  if (!nameInput) {
    const nameLabel = Array.from(document.querySelectorAll("label")).find(l => l.textContent.trim().startsWith("이름"));
    if (nameLabel) {
      const sib = nameLabel.parentElement && nameLabel.parentElement.querySelector("input");
      if (sib) nameInput = sib;
    }
  }
  if (!nameInput) nameInput = document.querySelector("input[type='text']");

  // 생년월일: date 타입
  const birthInput = $("#birth") || document.querySelector("input[type='date']");

  // 전화번호: type=tel 또는 placeholder에 '010-'
  let phoneInput = $("#phone") || document.querySelector("input[type='tel']");
  if (!phoneInput) phoneInput = Array.from(document.querySelectorAll("input[placeholder]")).find(i => i.placeholder.includes("010-"));

  // 이메일: type=email 또는 placeholder에 '@'
const emailLocalInput  = document.getElementById("email-local");      // 아이디 부분
const emailDomainSelect = document.getElementById("email-domain-select"); // 셀렉트박스
const emailDomainInput = document.getElementById("email-domain");     // 직접입력용
const emailHidden = document.getElementById("email");                 // 숨김 최종값
function getSelectedDomain() {
  if (emailDomainSelect.value === "__custom__") {
    return (emailDomainInput.value || "").trim();
  }
  return emailDomainSelect.value;
}

function composeEmail() {
  const local  = (emailLocalInput.value || "").trim();
  const domain = getSelectedDomain();
  return local && domain ? `${local}@${domain}` : "";
}

// '직접입력' 선택 시 입력창 표시/숨김
emailDomainSelect.addEventListener("change", () => {
  const custom = emailDomainSelect.value === "__custom__";
  emailDomainInput.classList.toggle("hidden", !custom);
  emailDomainInput.disabled = !custom;
});

// 페이지 최초 상태도 맞춰주기
(() => {
  const custom = emailDomainSelect.value === "__custom__";
  emailDomainInput.classList.toggle("hidden", !custom);
  emailDomainInput.disabled = !custom;
})();

  // 필요하면 동적으로 id 부여(선택사항)
  if (nameInput && !nameInput.id) nameInput.id = "name";
  if (birthInput && !birthInput.id) birthInput.id = "birth";
  if (phoneInput && !phoneInput.id) phoneInput.id = "phone";
  if (emailInput && !emailInput.id) emailInput.id = "email";

  /** ---------- 검증 규칙 ---------- */
  function validateName(show=true){
  if (!nameInput) return false;
  const ok = isAtLeastThree(nameInput.value);
  if (show) {
    showToast(ok ? "이름이 올바릅니다 (최소 3글자)." : "이름은 최소 3글자 이상 입력하세요.",
              ok ? "success" : "error");
  }
  return ok;
}
/** ---------- 검증 규칙 ---------- */
const isAtLeastThree = (v) => v.trim().length >= 3;              // 이름: 최소 3글자
const phoneRegex     = /^\d{3}-(?:\d{3}|\d{4})-\d{4}$/;          // 전화: 3-3-4 또는 3-4-4 허용
const emailRegex     = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;             // 이메일: @와 . 포함

function validateEmail(show = true) {
  const email = composeEmail();                                  // 아이디 + 도메인 합치기
  const ok = emailRegex.test(email);

  const emailHidden = document.getElementById("email");
  if (emailHidden) emailHidden.value = email;

  if (show) {
    showToast(
      ok ? "이메일이 올바릅니다." : "이메일 형식을 확인하세요.",
      ok ? "success" : "error"
    );
  }
  return ok;
}
  function validatePhone(show=true){
    if (!phoneInput) return false;
    const ok = phoneRegex.test(phoneInput.value.trim());
    show && showToast(ok ? "전화번호 형식이 올바릅니다." : "전화번호는 000-0000-0000 형식으로 입력하세요.", ok?"success":"error");
    return ok;
  }

  function validateEmail(show=true){
  const email = composeEmail();
  const ok = emailRegex.test(email);

  if (show) {
    showToast(ok ? "이메일이 올바릅니다." : "이메일 형식을 확인하세요.",
              ok ? "success" : "error");
  }
  return ok;
}

  }
  function validateBirth(show=true){
    if (!birthInput) return false;
    const ok = !!birthInput.value;
    show && showToast(ok ? "생년월일 입력 완료." : "생년월일을 선택하세요.", ok?"success":"error");
    return ok;
  }

  /** ---------- 이벤트 연결 (blur 시 토스트) ---------- */
  nameInput  && nameInput.addEventListener("blur", () => validateName(true));
  phoneInput && phoneInput.addEventListener("blur", () => validatePhone(true));
 document.getElementById("email-local")
  .addEventListener("blur", () => validateEmail(true));

document.getElementById("email-domain-select")
  .addEventListener("change", () => validateEmail(true));
emailDomainInput && emailDomainInput.addEventListener("blur", () => validateEmail(true));

  birthInput && birthInput.addEventListener("blur", () => validateBirth(true));

  /** ---------- 제출/초기화 버튼 자동 탐지 ---------- */
  const submitBtn = document.getElementById("submitBtn") || Array.from(document.querySelectorAll("button")).find(b => /제출/.test(b.textContent));
  const resetBtn  = document.getElementById("resetBtn")  || Array.from(document.querySelectorAll("button")).find(b => /초기화/.test(b.textContent));

  submitBtn && submitBtn.addEventListener("click", () => {
    const okName  = validateName(false);
    const okPhone = validatePhone(false);
    const okEmail = validateEmail(false);
    const okBirth = validateBirth(false);

    if (okName && okPhone && okEmail && okBirth) {
      showToast("제출 가능한 상태입니다 ✅", "success");
    } else {
      !okName  && showToast("이름: 3글자 규칙 이상", "error");
      !okPhone && showToast("전화번호: 000-0000-0000", "error");
      !okEmail && showToast("이메일 형식 확인", "error");
      !okBirth && showToast("생년월일 선택", "error");
      showToast("입력값을 확인해 주세요 ⚠️", "warn");
    }
  });

  resetBtn && resetBtn.addEventListener("click", () => showToast("양식을 초기화했어요.", "info"));

  // 로드 확인용(원하면 지워도 됨)
  // showToast("토스트 스크립트 로드 완료", "info", 1500);
  
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const edu = document.getElementById("edu-year");
  if (!edu) return;

  flatpickr(edu, {
    locale: "ko",
    plugins: [
      new monthSelectPlugin({
        shorthand: false,         // Jan→1월, Feb→2월
        dateFormat: "Y-m",        // 값: 2025-08
        altFormat: "Y년 n월",      // 표시: 2025년 8월
        theme: "light"
      })
    ],
    minDate: "1980-01",
    maxDate: "2035-12",
    allowInput: false,
    clickOpens: true
  });
});
</script>

</body>
</html>
